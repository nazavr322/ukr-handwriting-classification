schema: '2.0'
stages:
  clean_data:
    cmd: python src/data/clean_data.py data/raw/glyphs.csv data/interim/data_cleaned.csv
    deps:
    - path: data/raw/glyphs.csv
      md5: e25acb0764504378eb5d5ffaf1eff861
      size: 68252
    outs:
    - path: data/interim/data_cleaned.csv
      md5: d38d09b5b430723610317fad2c26e161
      size: 22855
  prepare_mnist:
    cmd: python src/data/prepare_mnist.py data/raw 50 data/interim/digits.csv data/interim/digits/
    deps:
    - path: data/raw/MNIST/raw/
      md5: d0193be11ab497254ec667a4864050d9.dir
      size: 54950048
      nfiles: 4
    outs:
    - path: data/interim/digits.csv
      md5: 664892ae0586507ae6c75eddf776a96b
      size: 11927
    - path: data/interim/digits/
      md5: c7995e76c4b4fb69f9c3a623a7164c5a.dir
      size: 235978
      nfiles: 500
  make_dataset:
    cmd: python -m src.data.make_dataset data/interim/data_cleaned.csv data/interim/digits.csv
      data/processed/final.csv
    deps:
    - path: data/interim/data_cleaned.csv
      md5: d38d09b5b430723610317fad2c26e161
      size: 22855
    - path: data/interim/digits.csv
      md5: 664892ae0586507ae6c75eddf776a96b
      size: 11927
    outs:
    - path: data/processed/final.csv
      md5: cc992156dc00c3e5e08d62b7cab8cb32
      size: 37007
  train_test_split:
    cmd: python src/data/split_train_test.py data/processed/final.csv
    deps:
    - path: data/processed/final.csv
      md5: cc992156dc00c3e5e08d62b7cab8cb32
      size: 37007
    outs:
    - path: data/processed/test_data.csv
      md5: d298ed5f35958344cb2db903757fee52
      size: 7014
    - path: data/processed/train_data.csv
      md5: 000b7fd561981101b12365cb85c5f7ee
      size: 30030
  prepare_glyphs:
    cmd: python src/data/prepare_glyphs.py data/raw/glyphs/ data/interim/glyphs/
    deps:
    - path: data/raw/glyphs/
      md5: 3b1e52247eb8122b5bcb26fa2bd25bcb.dir
      size: 1722818
      nfiles: 1095
    outs:
    - path: data/interim/glyphs/
      md5: 88e25d3eff915d10ba29201efd8c5c26.dir
      size: 291050
      nfiles: 1095
  merge_pictures:
    cmd: python src/data/merge_pictures.py data/interim/glyphs/ data/interim/digits/
    deps:
    - path: data/interim/digits/
      md5: c7995e76c4b4fb69f9c3a623a7164c5a.dir
      size: 235978
      nfiles: 500
    - path: data/interim/glyphs/
      md5: 88e25d3eff915d10ba29201efd8c5c26.dir
      size: 291050
      nfiles: 1095
    outs:
    - path: data/processed/glyphs/
      md5: 3efeb69678d8cca5f95dc5d61871f782.dir
      size: 527028
      nfiles: 1595
  train_and_evaluate:
    cmd: python -m src.models.train_and_eval data/processed/train_data.csv data/processed/test_data.csv
      models/mnist_model.pt models/best_params.json models/test_run.pt reports/figures/
    deps:
    - path: data/processed/test_data.csv
      md5: d298ed5f35958344cb2db903757fee52
      size: 7014
    - path: data/processed/train_data.csv
      md5: 000b7fd561981101b12365cb85c5f7ee
      size: 30030
    - path: models/best_params.json
      md5: 46cd7d7adbeddc8cb8ab78a5c5836daa
      size: 249
    - path: models/mnist_model.pt
      md5: 888469a8360c8d350bfb7943db4f027d
      size: 3312672
    outs:
    - path: models/test_run.pt
      md5: 68f09681ac595e1f1dbd8a6f7f4a7913
      size: 3348314
  train:
    cmd: python -m src.models.train data/processed/train_data.csv models/mnist_model.pt
      models/best_params.json models/test_run.pt
    deps:
    - path: data/processed/train_data.csv
      md5: 000b7fd561981101b12365cb85c5f7ee
      size: 30030
    - path: models/best_params.json
      md5: 46cd7d7adbeddc8cb8ab78a5c5836daa
      size: 249
    - path: models/mnist_model.pt
      md5: 888469a8360c8d350bfb7943db4f027d
      size: 3312672
    outs:
    - path: models/test_run.pt
      md5: e34a10bef3043e0816e908b0351f1c29
      size: 3348314
  evaluate:
    cmd: python -m src.models.evaluate data/processed/test_data.csv models/test_run.pt
      reports/figures/
    deps:
    - path: data/processed/test_data.csv
      md5: d298ed5f35958344cb2db903757fee52
      size: 7014
    - path: models/test_run.pt
      md5: e34a10bef3043e0816e908b0351f1c29
      size: 3348314
